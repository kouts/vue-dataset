(function(c,e){typeof exports=="object"&&typeof module<"u"?e(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],e):(c=typeof globalThis<"u"?globalThis:c||self,e(c.VueDataset={},c.Vue))})(this,(function(c,e){"use strict";function P(n,s,a){let t;return function(){const r=this,i=arguments;clearTimeout(t),t=setTimeout(function(){t=null,n.apply(r,i)},s)}}function D(n){for(const s in n)return!1;return!0}function E(n,s){const t=[],r=[];let i;if(t.push(1),n<=1)return t;for(let o=s-2;o<=s+2;o++)o<n&&o>1&&t.push(o);t.push(n);for(let o=0;o<t.length;o++)i&&(t[o]-i===2?r.push(i+1):t[o]-i!==1&&r.push("...")),r.push(t[o]),i=t[o];return r}function k(n,s={}){const a=[];let t;const r=n.length;return n=n.map(function(i,o){return i[0]==="-"?(a[o]=-1,i=i.substring(1)):a[o]=1,i}),function(i,o){for(t=0;t<r;t++){const d=n[t],m=s[d]?s[d](i.value[d]):i.value[d],g=s[d]?s[d](o.value[d]):o.value[d];if(m>g)return a[t];if(m<g)return-a[t]}return 0}}function x(n,s){for(const a in s)n=n.filter(function(t){const r=t.value;for(const i in r)if(i===a){if(typeof s[a]=="function")return s[a](r[i],r);if(s[a]===""||r[i]===s[a])return!0}return!1});return n}function I(n,s,a,t){t=String(t).toLowerCase();for(const r in a)if(n.length===0||n.indexOf(r)!==-1){const i=String(a[r]).toLowerCase();for(const o in s)if(o===r&&typeof s[o]=="function"){const d=s[o](i,t,a);if(d===!0)return d}if(i.indexOf(t)>=0)return!0}return!1}const N={show:"Show",entries:"entries",previous:"Previous",next:"Next",showing:"Showing",showingTo:"to",showingOf:"of",showingEntries:"entries"},h=(n,s)=>{const a=n.__vccOpts||n;for(const[t,r]of s)a[t]=r;return a},B={name:"Dataset",props:{dsData:{type:Array,default:()=>[]},dsFilterFields:{type:Object,default:()=>({})},dsSortby:{type:Array,default:()=>[]},dsSearchIn:{type:Array,default:()=>[]},dsSearchAs:{type:Object,default:()=>({})},dsSortAs:{type:Object,default:()=>({})}},emits:["update:dsData"],setup(n,{emit:s}){const a=e.ref(1),t=e.ref(""),r=e.ref(10),i=e.ref(N),o=e.ref([]),d=l=>{t.value=l},m=async l=>{r.value=l,await e.nextTick(),a.value>y.value&&g(u.value[u.value.length-1])},g=l=>{a.value=l},b=e.computed(()=>o.value.slice(w.value,_.value)),u=e.computed(()=>E(y.value,a.value)),S=e.computed(()=>o.value.length),y=e.computed(()=>Math.ceil(S.value/r.value)),w=e.computed(()=>(a.value-1)*r.value),_=e.computed(()=>a.value*r.value);return e.watch(S,(l,f)=>{g(1)}),e.watch(()=>[n.dsData,t,n.dsSortby,n.dsFilterFields,n.dsSearchIn,n.dsSearchAs,n.dsSortAs],()=>{let l=[];!t.value&&!n.dsSortby.length&&D(n.dsFilterFields)?l=n.dsData.map((f,p)=>p):(l=n.dsData.map((f,p)=>({index:p,value:f})),D(n.dsFilterFields)||(l=x(l,n.dsFilterFields)),t.value&&(l=l.filter(f=>I(n.dsSearchIn,n.dsSearchAs,f.value,t.value))),n.dsSortby.length&&l.sort(k(n.dsSortby,n.dsSortAs)),l=l.map(f=>f.index)),o.value=l,s("update:dsData",l.map(f=>n.dsData[f]))},{immediate:!0,deep:!0}),e.provide("dsIndexes",o),e.provide("search",d),e.provide("showEntries",m),e.provide("setActive",g),e.provide("datasetI18n",i),e.provide("dsData",e.computed(()=>n.dsData)),e.provide("dsRows",b),e.provide("dsSearch",t),e.provide("dsShowEntries",r),e.provide("dsPages",u),e.provide("dsResultsNumber",S),e.provide("dsPagecount",y),e.provide("dsFrom",w),e.provide("dsTo",_),e.provide("dsPage",a),{dsIndexes:o,dsShowEntries:r,dsResultsNumber:S,dsPage:a,dsPagecount:y,dsFrom:w,dsTo:_,dsRows:b,dsPages:u,search:d,showEntries:m,setActive:g}}};function j(n,s,a,t,r,i){return e.renderSlot(n.$slots,"default",{ds:{dsIndexes:t.dsIndexes,dsShowEntries:t.dsShowEntries,dsResultsNumber:t.dsResultsNumber,dsPage:t.dsPage,dsPagecount:t.dsPagecount,dsFrom:t.dsFrom,dsTo:t.dsTo,dsData:a.dsData,dsRows:t.dsRows,dsPages:t.dsPages,search:t.search,showEntries:t.showEntries,setActive:t.setActive}})}const R=h(B,[["render",j]]),A={name:"DatasetInfo",setup(){const n=e.inject("dsResultsNumber"),s=e.inject("dsFrom"),a=e.inject("dsTo"),t=e.computed(()=>n.value!==0?s.value+1:0),r=e.computed(()=>a.value>=n.value?n.value:a.value);return{datasetI18n:e.inject("datasetI18n"),dsResultsNumber:n,showing:t,showingTo:r}}};function F(n,s,a,t,r,i){return e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(t.datasetI18n.showing)+" "+e.toDisplayString(t.showing)+" "+e.toDisplayString(t.datasetI18n.showingTo)+" "+e.toDisplayString(t.showingTo)+" "+e.toDisplayString(t.datasetI18n.showingOf)+" "+e.toDisplayString(t.dsResultsNumber)+" "+e.toDisplayString(t.datasetI18n.showingEntries),1)}const T=h(A,[["render",F]]),V={name:"DatasetItem",props:{tag:{type:String,default:"div"}},setup(){const n=e.computed(()=>{const s=[];for(let a=e.inject("dsFrom").value;a<e.inject("dsTo").value;a++)s.push(a);return s});return{dsData:e.inject("dsData"),dsRows:e.inject("dsRows"),indexes:n}}};function C(n,s,a,t,r,i){return e.openBlock(),e.createBlock(e.resolveDynamicComponent(a.tag),null,{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.dsRows,(o,d)=>e.renderSlot(n.$slots,"default",{row:t.dsData[o],rowIndex:o,index:t.indexes[d]})),256)),t.dsRows.length?e.createCommentVNode("",!0):e.renderSlot(n.$slots,"noDataFound",{key:0})]),_:3})}const O=h(V,[["render",C]]),M={name:"DatasetPager",setup(){const n=e.ref("..."),s=e.inject("dsPage"),a=e.inject("dsPagecount"),t=e.computed(()=>s.value===1),r=e.computed(()=>s.value===a.value||a.value===0);return{datasetI18n:e.inject("datasetI18n"),setActive:e.inject("setActive"),dsPages:e.inject("dsPages"),dsPagecount:a,dsPage:s,morePages:n,disabledPrevious:t,disabledNext:r}}},L={class:"pagination"},z=["tabindex","aria-disabled"],G=["onClick"],K={key:1,class:"page-link"},q=["tabindex","aria-disabled"];function W(n,s,a,t,r,i){return e.openBlock(),e.createElementBlock("ul",L,[e.createElementVNode("li",{class:e.normalizeClass(["page-item",t.disabledPrevious&&"disabled"])},[e.createElementVNode("a",{class:"page-link",href:"#",tabindex:t.disabledPrevious?"-1":null,"aria-disabled":t.disabledPrevious?"true":null,onClick:s[0]||(s[0]=e.withModifiers(o=>t.setActive(t.dsPage!==1&&t.dsPagecount!==0?t.dsPage-1:t.dsPage),["prevent"]))},e.toDisplayString(t.datasetI18n.previous),9,z)],2),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.dsPages,(o,d)=>(e.openBlock(),e.createElementBlock("li",{key:d,class:e.normalizeClass(["page-item",o===t.dsPage&&"active",o===t.morePages&&"disabled"])},[o!==t.morePages?(e.openBlock(),e.createElementBlock("a",{key:0,class:"page-link",href:"#",onClick:e.withModifiers(m=>t.setActive(o),["prevent"])},e.toDisplayString(o),9,G)):(e.openBlock(),e.createElementBlock("span",K,e.toDisplayString(o),1))],2))),128)),e.createElementVNode("li",{class:e.normalizeClass(["page-item",t.disabledNext&&"disabled"])},[e.createElementVNode("a",{class:"page-link",href:"#",tabindex:t.disabledNext?"-1":null,"aria-disabled":t.disabledNext?"true":null,onClick:s[1]||(s[1]=e.withModifiers(o=>t.setActive(t.dsPage!==t.dsPagecount&&t.dsPagecount!==0?t.dsPage+1:t.dsPage),["prevent"]))},e.toDisplayString(t.datasetI18n.next),9,q)],2)])}const H=h(M,[["render",W]]),J={name:"DatasetSearch",props:{dsSearchPlaceholder:{type:String,default:""},wait:{type:Number,default:0}},setup(n){const s=e.inject("search"),a=e.ref(""),t=P(r=>{s(r)},n.wait);return{dsSearch:a,input:t}}},Q=["placeholder","value"];function U(n,s,a,t,r,i){return e.openBlock(),e.createElementBlock("input",{type:"text",placeholder:a.dsSearchPlaceholder,class:"form-control",value:t.dsSearch,onInput:s[0]||(s[0]=o=>t.input(o.target.value))},null,40,Q)}const X=h(J,[["render",U]]),Y={name:"DatasetShow",props:{dsShowEntries:{type:Number,default:10},dsShowEntriesLovs:{type:Array,default:()=>[{value:5,text:5},{value:10,text:10},{value:25,text:25},{value:50,text:50},{value:100,text:100}]}},emits:["changed"],setup(n,{emit:s}){const a=e.inject("showEntries"),t=r=>{s("changed",Number(r.target.value)),a(Number(r.target.value))};return a(Number(n.dsShowEntries)),{datasetI18n:e.inject("datasetI18n"),change:t}}},Z={class:"form-inline"},v=["value"],$=["value"];function ee(n,s,a,t,r,i){return e.openBlock(),e.createElementBlock("div",Z,[e.createElementVNode("label",null,e.toDisplayString(t.datasetI18n.show),1),e.createElementVNode("select",{value:a.dsShowEntries,class:"form-control mr-1 ml-1",onChange:s[0]||(s[0]=(...o)=>t.change&&t.change(...o))},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.dsShowEntriesLovs,o=>(e.openBlock(),e.createElementBlock("option",{key:o.value,value:o.value},e.toDisplayString(o.text),9,$))),128))],40,v),e.createElementVNode("label",null,e.toDisplayString(t.datasetI18n.entries),1)])}const te=h(Y,[["render",ee]]);c.Dataset=R,c.DatasetInfo=T,c.DatasetItem=O,c.DatasetPager=H,c.DatasetSearch=X,c.DatasetShow=te,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})}));
